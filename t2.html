<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Pomodoro Timer</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: left;
      margin-top: 12px;
    }
    #time {
      font-size: 12px;
      margin-bottom: 20px;
    }
    button {
      padding: 5px 10px;
      font-size: 10px;
      margin: 5px;
    }
  </style>
</head>
<body>
 <div id="time">60:00</div>
  <button onclick="startTimer()">Démarrer</button>
  <button onclick="pauseTimer()">Pause</button>
  <button onclick="resetTimer()">Remise à zéro</button>

  <script>
    let workDuration = 60 * 60; // 60 minutes en secondes
    let breakDuration = 5 * 60; // 5 minutes en secondes
    let timeLeft = workDuration;
    let timer;
    let isRunning = false;
    let onBreak = false;

    function formatTime(seconds) {
      const minutes = Math.floor(seconds / 60).toString().padStart(2, '0');
      const secs = (seconds % 60).toString().padStart(2, '0');
      return `${minutes}:${secs}`;
    }

    function timeUntil20h() {
      const now = new Date();
      const target = new Date();
      target.setHours(20, 0, 0, 0); // 20h00
      let diff = target - now;

      if (diff < 0) diff = 0; // Si on dépasse 20h

      const hours = Math.floor(diff / (1000 * 60 * 60)).toString().padStart(2, '0');
      const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60)).toString().padStart(2, '0');
      return `${hours}:${minutes}`;
    }

    function updateTitle() {
      document.title = `${formatTime(timeLeft)} | Jusqu'à 20h: ${timeUntil20h()}`;
    }

    function updateDisplay() {
      document.getElementById('time').textContent = formatTime(timeLeft);
      updateTitle();
    }

    function tick() {
      if (timeLeft > 0) {
        timeLeft--;
        updateDisplay();
      } else {
        if (!onBreak) {
          onBreak = true;
          timeLeft = breakDuration;
          alert("Pause de 5 minutes !");
        } else {
          onBreak = false;
          timeLeft = workDuration;
          alert("Reprise du travail !");
        }
      }
    }

    function startTimer() {
      if (!isRunning) {
        isRunning = true;
        timer = setInterval(tick, 1000);
      }
    }

    function pauseTimer() {
      clearInterval(timer);
      isRunning = false;
    }

    function resetTimer() {
      clearInterval(timer);
      isRunning = false;
      onBreak = false;
      timeLeft = workDuration;
      updateDisplay();
    }

    // Initial display
    updateDisplay();
    // Always update title every second
    setInterval(updateTitle, 1000);
  </script>
</body>
</html>
